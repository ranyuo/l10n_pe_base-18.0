<odoo>

    <template id="partner_document_page" name="Partner Document Page">
        <t t-call="website.layout">
            <div class="container mt-4">
                <style>
                    .partner-document-title {
                        font-weight: 700;
                        text-transform: uppercase;
                    }

                    .partner-document-subtitle {
                        font-size: 1.1rem;
                        margin-bottom: 1.5rem;
                        color: #6c757d;
                    }

                    .partner-document-table {
                        border: 2px solid #0d6efd;
                        border-collapse: collapse;
                    }

                    .partner-document-table thead th {
                        font-weight: 700;
                        border-bottom: 2px solid #0d6efd;
                        background-color: #0d6efd;
                        color: #ffffff;
                    }

                    .partner-document-table td,
                    .partner-document-table th {
                        border: 1px solid #0d6efd;
                    }

                    .btn-print {
                        background-color: #0d6efd;
                        color: #ffffff;
                        border-color: #0d6efd;
                    }

                    .btn-print:hover,
                    .btn-print:focus {
                        background-color: #0b5ed7;
                        border-color: #0a58ca;
                        color: #ffffff;
                    }

                    @media print {
                        body * {
                            visibility: hidden;
                        }

                        #print-area,
                        #print-area *,
                        .partner-document-title {
                            visibility: visible;
                        }

                        #print-area {
                            position: absolute;
                            left: 0;
                            top: 0;
                            width: 100%;
                        }

                        .partner-document-title {
                            margin-bottom: 12px;
                        }

                        .no-print {
                            display: none !important;
                        }
                    }
                </style>

                <div id="print-area">
                    <h1 class="partner-document-title">CERTIFICADOS DEL PARTICIPANTE</h1>
                    <p class="partner-document-subtitle">-En este módulo Ud. podrá consultar información sobre su certificado/constancia Ingrese su N° Documento de Identificación.</p>

                    <form action="/partner-document" method="get" class="mb-4 no-print" id="partner-document-search-form">
                        <div class="mb-2" id="math-challenge-wrapper">
                            <label class="form-label mb-1">Resuelva la siguiente operación para habilitar la búsqueda:</label>
                            <div class="input-group">
                                <span class="input-group-text" id="math-challenge-text"></span>
                                <input type="number" class="form-control" id="math-challenge-answer" placeholder="Resultado" min="0"/>
                            </div>
                            <div class="form-text">Ingrese el resultado correcto para activar el botón "Buscar".</div>
                        </div>
                        <div class="input-group">
                            <input type="text" name="search" class="form-control"
                                   placeholder="Buscar por nombre de contacto, dni de contacto o código de documento"
                                   t-att-value="search"/>
                            <button type="submit" class="btn btn-primary" id="partner-document-search-button" disabled="disabled">Buscar</button>
                        </div>
                    </form>

                    <t t-if="model_missing">
                        <div class="alert alert-danger" role="alert">
                            No se encontró el registro de certificados. Por favor, contacte al administrador del sistema.
                        </div>
                    </t>
                    <t t-elif="partner_documents">
                        <div class="d-flex justify-content-end mb-2 no-print">
                            <button type="button" class="btn btn-print" onclick="window.print()">
                                Imprimir
                            </button>
                        </div>
                        <div class="table-responsive" style="font-size: 12px;">
                            <table class="table table-striped table-small partner-document-table">
                                <thead>
                                    <tr>
                                        <th>DNI</th>
                                        <th>Certificado</th>
                                        <th>Participante</th>
                                        <th>Actividad</th>
                                        <th>Fecha</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="partner_documents" t-as="c">
                                        <tr>
                                            <td><t t-esc="c.partner_vat"/></td>
                                            <td><t t-esc="c.partner_code or ''"/></td>
                                            <td><t t-esc="c.partner_id.name or ''"/></td>
                                            <td><t t-esc="c.name or ''"/></td>
                                            <td><t t-esc="c.issue_date or ''"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </t>
                    <t t-else="">
                        <p>No se encontraron documentos.</p>
                    </t>
                </div>

                <nav aria-label="Page navigation" class="mt-4 no-print">
                    <ul class="pagination">
                        <li class="page-item" t-att-class="page == 1 and 'disabled'">
                            <a class="page-link"
                               t-att-href="'/partner-document/page/%s?search=%s' % (page-1, search or '')">Anterior</a>
                        </li>

                        <t t-foreach="range(1, pages+1)" t-as="p">
                            <li class="page-item" t-att-class="p == page and 'active'">
                                <a class="page-link"
                                   t-att-href="'/partner-document/page/%s?search=%s' % (p, search or '')">
                                    <t t-esc="p"/>
                                </a>
                            </li>
                        </t>

                        <li class="page-item" t-att-class="page == pages and 'disabled'">
                            <a class="page-link"
                               t-att-href="'/partner-document/page/%s?search=%s' % (page+1, search or '')">Siguiente</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </t>
    </template>
    <template id="partner_document_assets" inherit_id="web.assets_frontend">
        <xpath expr="." position="inside">
            <script type="text/javascript">
                (function () {
                    const initMathChallenge = function () {
                        const wrapper = document.getElementById('math-challenge-wrapper');
                        if (!wrapper || wrapper.dataset.challengeInit === '1') {
                            return;
                        }
                        wrapper.dataset.challengeInit = '1';

                        const challengeText = document.getElementById('math-challenge-text');
                        const answerInput = document.getElementById('math-challenge-answer');
                        const searchButton = document.getElementById('partner-document-search-button');

                        if (!challengeText || !answerInput || !searchButton) {
                            return;
                        }

                        const generateChallenge = function () {
                            const firstNumber = Math.floor(Math.random() * 9) + 1;
                            const secondNumber = Math.floor(Math.random() * 9) + 1;
                            const expected = firstNumber + secondNumber;

                            challengeText.textContent = `${firstNumber} + ${secondNumber} =`;
                            answerInput.value = '';
                            answerInput.classList.remove('is-valid', 'is-invalid');
                            searchButton.disabled = true;
                            wrapper.dataset.expectedResult = expected;
                        };

                        const validateAnswer = function () {
                            const expected = parseInt(wrapper.dataset.expectedResult || '', 10);
                            const value = parseInt(answerInput.value, 10);

                            if (!isNaN(value) &amp;&amp; value === expected) {
                                searchButton.disabled = false;
                                answerInput.classList.add('is-valid');
                                answerInput.classList.remove('is-invalid');
                            } else {
                                searchButton.disabled = true;
                                if (answerInput.value !== '') {
                                    answerInput.classList.add('is-invalid');
                                    answerInput.classList.remove('is-valid');
                                } else {
                                    answerInput.classList.remove('is-invalid', 'is-valid');
                                }
                            }
                        };

                        generateChallenge();
                        answerInput.addEventListener('input', validateAnswer);
                    };

                    document.addEventListener('DOMContentLoaded', initMathChallenge);
                    document.addEventListener('odoo:page-ready', initMathChallenge);
                })();
            </script>
        </xpath>
    </template>
</odoo>
