<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <record id="view_move_form_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.move.form.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">

                <xpath expr="//form/sheet/div[hasclass('oe_button_box')]" position="inside">
                  <button name="action_account_move_line_views" class="oe_stat_button" icon="fa-list-ol" type="object" string="Apuntes Contables" invisible ="state not in ['posted']"/>
                </xpath>

                <field name="invoice_date" position="after">
                    <field name="is_invoice_in_me" invisible="1"/>
                    <field name="currency_tc" readonly="1" invisible="is_invoice_in_me != True" force_save="1"/>
                </field>

                <xpath expr="//page[@id='other_tab_entry']/group[@id='other_tab_entry_group']/group[@name='misc_group']/field[@name='auto_post']" position="after">
                    <field name="is_closing_process" readonly="1" invisible="move_type not in ['entry']"/>
                    <field name="is_opening_process" readonly="1" invisible="move_type not in ['entry']"/>
                </xpath>

                
                <xpath expr="//group[@id='header_left_group']/field[@name='ref']" position="after">
                    <field name="allow_edit_prefix_code_invoice_number" invisible="1"/>
                    <div class="o_td_label">
                        <label for="l10n_pe_prefix_code"/>
                    </div>
                    <field name="l10n_pe_prefix_code" nolabel="1" readonly="(move_type in ['out_invoice','out_refund'] and not allow_edit_prefix_code_invoice_number) or (move_type in ['in_invoice','in_refund'] and state in ['posted','cancel'])"/>
                    <div class="o_td_label">
                        <label for="l10n_pe_invoice_number"/>
                    </div>
                    <field name="l10n_pe_invoice_number" nolabel="1" readonly="(move_type in ['out_invoice','out_refund'] and not allow_edit_prefix_code_invoice_number) or (move_type in ['in_invoice','in_refund'] and state in ['posted','cancel'])"/>
                </xpath>

                <xpath expr="//form/sheet/notebook/page/field[@name='line_ids']/list/field[@name='account_id']" position="before">
                    <field name="id_mov" optional="show" readonly="1"/>
                </xpath>

                <xpath expr="//form/sheet/notebook/page/field[@name='line_ids']/list/field[@name='name']" position="before">
                    <field name="operation_number" optional="hide"/>
                </xpath>

                
                <xpath expr="//form/sheet/notebook/page/field[@name='line_ids']/list/field[@name='name']" position="after">
                    <field name="l10n_latam_document_type_id" string="Tipo Comprobante" optional="show"/>
                    <field name="l10n_pe_prefix_code" optional="show"/>
                    <field name="l10n_pe_invoice_number" optional="show"/>
                    <field name="date_emission" optional="hide"/>
                </xpath>
            
            </field>
        </record>

        <!-- ################################################################################# -->

        <record id="view_invoice_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.invoice.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_invoice_tree"/>
            <field name="arch" type="xml">

                <field name="name" position="before">
                    <field name="id_mov" optional="show" readonly="1"/>
                </field>

            </field>
        </record>


        <record id="view_out_invoice_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.out.invoice.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_out_invoice_tree"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="l10n_latam_document_type_id" string="Tipo Comprobante" optional="show"/>
                    <field name="l10n_pe_prefix_code" optional="show"/>
                    <field name="l10n_pe_invoice_number" optional="show"/>
                </field>
            </field>
        </record>


        <record id="view_out_credit_note_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.out.credit.note.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_out_credit_note_tree"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="l10n_latam_document_type_id" string="Tipo Comprobante" optional="show"/>
                    <field name="l10n_pe_prefix_code" optional="show"/>
                    <field name="l10n_pe_invoice_number" optional="show"/>
                </field>
            </field>
        </record>

        <!-- ################################################################################ -->


        <record id="view_in_invoice_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.in.invoice.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_in_invoice_bill_tree"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="l10n_latam_document_type_id" string="Tipo Comprobante" optional="show"/>
                    <field name="l10n_pe_prefix_code" optional="show"/>
                    <field name="l10n_pe_invoice_number" optional="show"/>
                </field>
            </field>
        </record>


        <record id="view_in_invoice_refund_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.in.invoice.refund.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_in_invoice_refund_tree"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="l10n_latam_document_type_id" string="Tipo Comprobante" optional="show"/>
                    <field name="l10n_pe_prefix_code" optional="show"/>
                    <field name="l10n_pe_invoice_number" optional="show"/>
                </field>
            </field>
        </record>


        <!-- ################################################################################# -->


        <record id="view_move_filter_view_move_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.move.filter.view.move.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_account_invoice_filter"/>
            <field name="arch" type="xml">
                <field name="journal_id" position="after">
                    <field name="l10n_pe_prefix_code"/>
                    <field name="l10n_pe_invoice_number"/>
                </field>
                <field name="name" position="after">
                    <field name="id_mov"/>
                </field>

            </field>
        </record>

        <!-- ###################################################################### -->

        <record id="view_move_line_tree" model="ir.ui.view">
            <field name="name">account.move.line.tree</field>
            <field name="model">account.move.line</field>
            <field name="inherit_id" ref="account.view_move_line_tree"/>
            <field name="arch" type="xml">
                <field name="move_id" position="before">
                    <field name="id_mov"/>
                </field>
                <field name="ref" position="after">
                    <field name="l10n_latam_document_type_id" string="Tipo Comprobante" optional="show"/>
                    <field name="l10n_pe_prefix_code" optional="show"/>
                    <field name="l10n_pe_invoice_number" optional="show"/>
                    <field name="date_emission" optional="show"/>
                </field>

                <field name="partner_id" position="after">
                    <field name="operation_number" optional="show"/>
                </field>

                <field name="account_id" position="after">
                    <field name="is_closing_process" readonly="1" optional="hide"/>
                    <field name="is_opening_process" readonly="1" optional="hide"/>
                </field>

            </field>
        </record>


        <record id="view_account_move_line_filter_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.account.move.line.filter.prefix.code.invoice.number</field>
            <field name="model">account.move.line</field>
            <field name="inherit_id" ref="account.view_account_move_line_filter"/>
            <field name="arch" type="xml">
                <field name="ref" position="before">
                    <field name="id_mov"/>
                </field>
            </field>
        </record>

        <!-- ####################################################################################### -->

        <record id="view_move_tree_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.move.tree.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_tree"/>
            <field name="arch" type="xml">

                <field name="company_currency_id" position="before">
                    <field name="id_mov" optional="show" readonly="1"/>
                </field>

            </field>
        </record>


        <record id="view_account_move_filter_prefix_code_invoice_number" model="ir.ui.view">
            <field name="name">view.account.move.filter.prefix.code.invoice.number</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_account_move_filter"/>
            <field name="arch" type="xml">

                <field name="ref" position="before">
                    <field name="id_mov"/>
                </field>

            </field>
        </record>


</odoo>